import { useEffect, useState } from "react";
import SocialAnim from "./social";

function ConocenosAnim() {

    const [rotate, setRotate] = useState(0);
    const [transitionDuration, setTransitionDuration] = useState(.5);
    const [scale, setScale] = useState(10);
    const [transitionTimingFunction, setTransitionTimingFunction] = useState("ease-out");
    const [top, setTop] = useState(100);
    const [likes, setLikes] = useState(0);
    const [likesDisplay, setLikesDisplay] = useState("");
    const [comments, setComments] = useState(0);
    const [commentsDisplay, setCommentsDisplay] = useState("");

    useEffect(() => {
        setTimeout(() => {
            setTop(-3);
            setScale(105);
            setRotate(-6);
        }, 1000)
        setTimeout(() => {
            setTransitionDuration(.3);
            setTransitionTimingFunction("ease-in")
            setTop(0);
            setScale(100);
            setRotate(3);
            increaseLikes();
        }, (transitionDuration * 1000) + 1000)
    }, [])

    useEffect(() => {
        var auxLikesK = Math.floor(likes / 1000);
        var auxLikesD = likes - (auxLikesK * 1000);
        var auxLikesDString;
        if (auxLikesD < 100) {
            if (auxLikesD < 10) {
                auxLikesDString = "00" + auxLikesD;
            } else {
                auxLikesDString = "0" + auxLikesD;
            }
        } else {
            auxLikesDString = auxLikesD;
        }
        setLikesDisplay(auxLikesK + "." + auxLikesDString)
    }, [likes])

    useEffect(() => {
        var auxcommentsK = Math.floor(comments / 1000);
        var auxcommentsD = comments - (auxcommentsK * 1000);
        var auxcommentsDString;
        if (auxcommentsD < 100) {
            auxcommentsDString = "0" + auxcommentsD;
        } else {
            auxcommentsDString = auxcommentsD;
        }
        setCommentsDisplay(auxcommentsK + "." + auxcommentsDString)
    }, [comments])

    function increaseLikes() {
        for (var i = 0; i < 100; i++) {
            setTimeout(() => {
                setLikes(prevCount => prevCount + Math.floor(Math.random() * 200))
            }, i * 10)
        }
    }

    return (
        <div className="relative w-[410px] h-[350px]">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 462 409" fill="none" className="w-full -bottom-2 left-1 absolute rotate-3">
                <path d="M448.059 355.464C444.858 345.92 441.688 332.309 441.88 314.566C442.072 309.986 442.616 304.606 443.801 298.713C444.89 293.3 446.33 288.528 447.803 284.461C447.803 284.461 450.909 274.981 453.759 258.135C460.963 220.567 461.283 189.469 460.195 167.787C458.37 131.565 456.384 100.563 435.38 70.9062C412.23 38.2709 379.186 25.5563 356.997 17.7738C273.811 -11.4026 127.067 -12.2353 47.2437 87.3039C25.0544 114.975 13.4635 146.393 13.4635 146.393C13.4635 146.393 12.3428 149.404 10.7418 154.4C10.7418 154.4 8.46847 159.108 5.65079 172.687C4.11387 179.125 2.67301 186.267 1.74445 193.537C-4.05102 237.958 4.72223 337.753 72.5388 383.263C124.218 417.916 188.384 408.468 230.585 402.223C305.254 391.206 344.381 357.738 411.398 373.143C432.978 378.107 449.596 386.306 459.907 392.167C460.323 392.327 460.899 392.423 461.283 392.167C464.133 390.277 453.759 372.534 448.059 355.432V355.464Z" fill="url(#paint0_linear_134_239)" />
                <defs>
                    <linearGradient id="paint0_linear_134_239" x1="231.016" y1="0.639435" x2="231.016" y2="408.298" gradientUnits="userSpaceOnUse">
                        <stop stop-color="#F2AC4E" />
                        <stop offset="1" stop-color="#F4CA58" />
                    </linearGradient>
                </defs>
            </svg>

            <svg viewBox="0 0 462 409" xmlns="http://www.w3.org/2000/svg" className="w-full h-full">
                <defs>
                    <clipPath id="clipPath">
                        <path d="M 448.059 355.464 C 444.858 345.92 441.688 332.309 441.88 314.566 C 442.072 309.986 442.616 304.606 443.801 298.713 C 444.89 293.3 446.33 288.528 447.803 284.461 C 447.803 284.461 450.909 274.981 453.759 258.135 C 460.963 220.567 461.283 189.469 460.195 167.787 C 458.37 131.565 454.403 -61.305 433.403 -90.965 C 422.368 -106.551 20.838 -99.548 17.506 -91.76 C 8.542 -70.81 2.673 186.267 1.744 193.537 C -4.051 237.958 4.722 337.753 72.539 383.263 C 124.218 417.916 188.384 408.468 230.585 402.223 C 305.254 391.206 344.381 357.738 411.398 373.143 C 432.978 378.107 449.596 386.306 459.907 392.167 C 460.323 392.327 460.899 392.423 461.283 392.167 C 464.133 390.277 453.759 372.534 448.059 355.432 L 448.059 355.464 Z" />
                    </clipPath>
                </defs>
                <img src="img/girl.png"
                    className="absolute top-0 left-0"
                />
            </svg>
            <div
                className="absolute w-full h-[400px] bottom-0 -left-[4px]"
                style={{
                    clipPath: "url(#clipPath)"
                }}
            >
                <div className="w-full h-full inset-0 m-auto relative">
                    <SocialAnim likes={true} className="top-20 left-14" delay={1}>
                        <svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M0.899085 6.02945C0.899085 5.15695 1.03637 4.36377 1.31093 3.64991C1.59159 2.92995 1.97903 2.31066 2.47324 1.79205C2.97355 1.27343 3.55013 0.873791 4.20297 0.593128C4.86192 0.306364 5.56663 0.162982 6.3171 0.162982C7.2018 0.162982 7.97972 0.346023 8.65087 0.712105C9.32202 1.07819 9.85894 1.55409 10.2616 2.13982C10.6704 1.55409 11.2073 1.07819 11.8724 0.712105C12.5435 0.346023 13.3245 0.162982 14.2153 0.162982C14.9719 0.162982 15.6766 0.306364 16.3294 0.593128C16.9823 0.873791 17.5558 1.27343 18.05 1.79205C18.5442 2.31066 18.9286 2.92995 19.2032 3.64991C19.4838 4.36377 19.6242 5.15695 19.6242 6.02945C19.6242 7.34124 19.2795 8.64083 18.59 9.92822C17.9005 11.2095 16.9304 12.4572 15.6796 13.6714C14.4289 14.8856 12.9554 16.0418 11.2592 17.14C11.0884 17.2499 10.9114 17.3505 10.7284 17.4421C10.5514 17.5397 10.3959 17.5885 10.2616 17.5885C10.1335 17.5885 9.97792 17.5397 9.79488 17.4421C9.61184 17.3505 9.43795 17.2499 9.27321 17.14C7.57703 16.0418 6.1005 14.8856 4.84362 13.6714C3.59284 12.4572 2.62272 11.2095 1.93327 9.92822C1.24381 8.64083 0.899085 7.34124 0.899085 6.02945ZM3.02236 6.02029C3.02236 6.78907 3.20845 7.57919 3.58064 8.39067C3.95282 9.19605 4.46228 9.99533 5.10903 10.7885C5.76187 11.5817 6.51539 12.3505 7.36958 13.0948C8.22377 13.8331 9.13593 14.5256 10.106 15.1723C10.1854 15.2273 10.2372 15.2547 10.2616 15.2547C10.286 15.2547 10.3409 15.2273 10.4264 15.1723C11.3965 14.5256 12.3056 13.8331 13.1537 13.0948C14.0079 12.3505 14.7614 11.5817 15.4142 10.7885C16.0671 9.99533 16.5765 9.19605 16.9426 8.39067C17.3148 7.57919 17.5009 6.78907 17.5009 6.02029C17.5009 5.28203 17.3484 4.63528 17.0433 4.08006C16.7443 3.51873 16.3325 3.08249 15.8078 2.77132C15.2831 2.45404 14.6882 2.29541 14.0231 2.29541C13.4862 2.29541 13.0286 2.38693 12.6503 2.56997C12.272 2.74691 11.9456 2.97266 11.671 3.24722C11.4026 3.52178 11.1646 3.79635 10.9572 4.07091C10.823 4.25395 10.704 4.38513 10.6003 4.46444C10.5026 4.54376 10.3898 4.58342 10.2616 4.58342C10.1335 4.58342 10.0176 4.54376 9.91385 4.46444C9.81013 4.38513 9.69115 4.25395 9.55692 4.07091C9.37388 3.79635 9.14508 3.52178 8.87052 3.24722C8.60206 2.97266 8.27259 2.74691 7.8821 2.56997C7.49771 2.38693 7.03706 2.29541 6.50014 2.29541C5.84119 2.29541 5.24936 2.45404 4.72464 2.77132C4.19992 3.08249 3.78503 3.51873 3.47996 4.08006C3.17489 4.63528 3.02236 5.28203 3.02236 6.02029Z" fill="#FFFDFD" />
                        </svg>
                    </SocialAnim>
                    <SocialAnim className="top-32 -right-5" delay={1.25}>
                        <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M6.15684 20.0043C5.75415 20.0043 5.43688 19.8731 5.20503 19.6108C4.97928 19.3484 4.8664 18.9884 4.8664 18.5308V16.3892H4.53693C3.67054 16.3892 2.91702 16.2154 2.27637 15.8676C1.63573 15.5137 1.13847 15.0103 0.784591 14.3575C0.436813 13.6985 0.262924 12.9115 0.262924 11.9963V4.8119C0.262924 3.8967 0.433762 3.11267 0.775439 2.45982C1.12322 1.80088 1.62353 1.29446 2.27637 0.940584C2.92922 0.586705 3.7163 0.409766 4.6376 0.409766H16.2241C17.1515 0.409766 17.9416 0.586705 18.5945 0.940584C19.2473 1.29446 19.7446 1.80088 20.0863 2.45982C20.434 3.11267 20.6079 3.8967 20.6079 4.8119V11.9963C20.6079 12.9115 20.434 13.6985 20.0863 14.3575C19.7446 15.0103 19.2473 15.5137 18.5945 15.8676C17.9416 16.2154 17.1515 16.3892 16.2241 16.3892H10.9434L7.83167 19.1349C7.48999 19.4399 7.19408 19.6596 6.94392 19.7938C6.69987 19.9341 6.43751 20.0043 6.15684 20.0043ZM6.65105 17.6705L9.5431 14.8242C9.74445 14.6168 9.93359 14.4795 10.1105 14.4124C10.2875 14.3392 10.5224 14.3026 10.8152 14.3026H16.1417C16.9593 14.3026 17.5664 14.1012 17.963 13.6985C18.3657 13.2897 18.567 12.6888 18.567 11.8956V4.91257C18.567 4.1194 18.3657 3.52146 17.963 3.11877C17.5664 2.70998 16.9593 2.50558 16.1417 2.50558H4.72912C3.91154 2.50558 3.3014 2.70998 2.89871 3.11877C2.50213 3.52146 2.30383 4.1194 2.30383 4.91257V11.8956C2.30383 12.6888 2.50213 13.2897 2.89871 13.6985C3.3014 14.1012 3.91154 14.3026 4.72912 14.3026H5.86398C6.12634 14.3026 6.32158 14.3636 6.44971 14.4856C6.58394 14.6015 6.65105 14.8059 6.65105 15.0988V17.6705Z" fill="#FFFDFD" />
                        </svg>
                    </SocialAnim>
                    <img src="img/girl.png"
                        className="absolute"
                        style={{
                            top: top + "%",
                            rotate: rotate + "deg",
                            scale: scale + "%",
                            transitionDuration: transitionDuration + "s",
                            transitionTimingFunction: transitionTimingFunction
                        }}
                    />
                </div>

            </div>
        </div>
    )
}

export default ConocenosAnim
